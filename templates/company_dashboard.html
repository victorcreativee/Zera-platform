{% extends 'base.html' %}

{% block content %}
<div class="company-dashboard-container">
  <h2 class="dashboard-title">🏢 Welcome, {{ company.name.upper() }}</h2>

  <div class="dashboard-actions">
    <a href="{{ url_for('company.add_product') }}" class="btn-primary">➕ Add New Product</a>
    <a href="{{ url_for('auth.logout_company') }}" class="btn-danger">🚪 Logout</a>
  </div>

  <h3 class="section-heading">📦 Your Products:</h3>
  {% if company.products %}
    <div class="product-grid">
      {% for product in company.products %}
      <div class="product-card">
        <h4 class="product-name">{{ product.name }}</h4>
        <p class="product-description">{{ product.description }}</p>

        <div class="product-actions">
          <a href="{{ url_for('company.edit_product', product_id=product.id) }}" class="btn-secondary">✏️ Edit</a>
          <a href="{{ url_for('company.delete_product', product_id=product.id) }}" class="btn-danger">🗑️ Delete</a>
        </div>

        <div class="review-section">
          <h5>📝 Reviews:</h5>
          {% if product.reviews %}
            <ul class="review-list">
              {% for review in product.reviews %}
                <li>
                  <div class="review-card">
                    <p><strong>{{ review.user_name }}</strong>: {{ review.content }}</p>
                    <form action="{{ url_for('main.rate_review', review_id=review.id) }}" method="POST">
                      <label for="rating-{{ review.id }}">Rate:</label>
                      <select name="rating" id="rating-{{ review.id }}">
                        <option value="1" {% if review.rating == 1 %}selected{% endif %}>1 - Poor</option>
                        <option value="2" {% if review.rating == 2 %}selected{% endif %}>2 - Fair</option>
                        <option value="3" {% if review.rating == 3 %}selected{% endif %}>3 - Good</option>
                        <option value="4" {% if review.rating == 4 %}selected{% endif %}>4 - Very Good</option>
                        <option value="5" {% if review.rating == 5 %}selected{% endif %}>5 - Excellent</option>
                      </select>
                      <button type="submit" class="btn-sm">✅ Save</button>
                      {% if review.points_awarded %}
                        <span class="points-earned">⭐ {{ review.points_awarded }} pts</span>
                      {% endif %}
                    </form>
                  </div>
                  
                </li>
              {% endfor %}
            </ul>
          {% else %}
            <p class="no-reviews">No reviews yet for this product.</p>
          {% endif %}
        </div>
      </div>
      {% endfor %}
    </div>
  {% else %}
    <p class="empty-message">You haven’t added any products yet.</p>
  {% endif %}
</div>
{% endblock %}
